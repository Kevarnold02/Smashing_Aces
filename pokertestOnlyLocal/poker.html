<!doctype <!DOCTYPE html>
<html>
<head>
	<title>poker test</title>


</head>

<body>
<p> Dealer's hand:</p>

<div id = 'dealer'>
<p id = 'dealerbesthand'></p>

</div>

<br>
<br>

<p> Player's hand: </p>

<div id = 'player'>
<p id = 'playerbesthand'></p>
</div>





<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
<script type="text/javascript">

 

//funtion returns a random integer from 1 to 13

function random_13 () {    

	var random_num = Math.floor((Math.random() * 13) + 1);

	return random_num;
}

//function returns a random suite out of the 4 available

function randomSuite () {

var suites = [null,'hearts','diamonds','clubs','spades'];



var random_suite = suites[(Math.floor((Math.random() * 4) + 1))];

	return random_suite;
}




dealerHand = [];

playerHand = [];

while (dealerHand.length < 3) {

	var newcard = random_13() + randomSuite();
	if (dealerHand.indexOf(newcard) < 0) {
		dealerHand.push(newcard);
	}
}

while (playerHand.length < 3) {

	var newcard2 = random_13() + randomSuite();
	if ((dealerHand.indexOf(newcard2) < 0) && (playerHand.indexOf(newcard2) < 0)) {
		playerHand.push(newcard2);
	}
}

playerCardRanks = [];
dealerCardRanks = [];

playerSuites = [];
dealerSuites = [];

for (i = 0; i < 3; i++) {

	splitCard = playerHand[i].match(/[a-zA-Z]+|[0-9]+/g);

	playerCardRanks.push(splitCard[0]);

	playerSuites.push(splitCard[1]);


	splitCard = dealerHand[i].match(/[a-zA-Z]+|[0-9]+/g);

	dealerCardRanks.push(splitCard[0]);

	dealerSuites.push(splitCard[1]);

	$('#dealer').append(dealerHand[i]);
	$('#player').append(playerHand[i]);
}

// console.log(dealerHand);

// console.log(dealerCardRanks);

// console.log(dealerSuites);

 BestHandInfo = function(nameOfHand,rankOfHand,highCard) {

		this.nameOfHand = nameOfHand,
		this.rankOfHand = rankOfHand,
		this.highToLow = highCard
	}




function checkHighCard (rankArr) {

	rankArr = rankArr.sort(function(a, b) //sorts array in descending order
		{return b-a});

	var handInfo = new BestHandInfo("High Card",1,[rankArr[0],rankArr[1],rankArr[2]]);

	return handInfo;  // returns highest card in sorted array
}

function checkPair (rankArr) {

	rankArr = rankArr.sort(function(a, b) //sorts array in descending order
		{return b-a});

	var highPairCard = 0;

	var kicker = 0;


	for (i=0;i < 2; i++) {
		if (rankArr[i] == rankArr[i+1]) {

			highPairCard = rankArr[i];
		}
	}

	if (highPairCard > 0) {			//only executes if a pair was found

		for (i=0;i<rankArr.length;i++) {

			if (rankArr[i]!=highPairCard) {

				kicker = rankArr[i];
			}
		}

	var handInfo = {
		nameOfHand:"Pair",
		rankOfHand:2,
		highPairCard:highPairCard,
		kicker:kicker
	}
	 return handInfo;
	}

	else {

		return false; 
	}
}

function checkFlush (cardSuites,rankArr) {


	rankArr = rankArr.sort(function(a, b) //sorts array in descending order
		{return b-a});


	if ((cardSuites[0] == cardSuites[1]) && (cardSuites[2] == cardSuites[1])) {

		var handInfo = new BestHandInfo("Flush",3,[rankArr[0],rankArr[1],rankArr[2]]);
		return handInfo;
	}
	else {

		return false;
	}
}



function checkStraight(rankArr) {


	rankArr = rankArr.sort(function(a, b) //sorts array in descending order
		{return b-a});


	//this if checks if there is an ace, queen, and king. ace being 1.

	if ((rankArr.indexOf(1) > (-1)) && (rankArr.indexOf(12) > (-1)) && (rankArr.indexOf(13) > (-1))) {

		var handInfo = new BestHandInfo("Straight",4,14); 
		return handInfo;
	}

	

	if (((rankArr[0] - rankArr[1]) == 1) && ((rankArr[1] - rankArr[2]) == 1)) {

		 var handInfo = new BestHandInfo("Straight",4,rankArr[0]); 
		 return handInfo;
	 }
	else {

		return false;
	}


}


function checkThreeKind (rankArr) {

	if ((rankArr[0] == rankArr[1]) && (rankArr[2] == rankArr[1])) {

		var handInfo = new BestHandInfo("Three of a kind",5,rankArr[0]);
		return handInfo;
	}
	else {

		return false;
	}

}










function getBestHand (rankArr,suiteArr) {



		if ((checkFlush(suiteArr,rankArr) != false) && ((checkStraight(rankArr) != false))) {
			 
			 var straightFlush = new BestHandInfo('Straight Flush',6,rankArr[0]);

			 return straightFlush;
		}
		else
		 if (checkThreeKind(rankArr) != false) {
			 return checkThreeKind(rankArr);
		}
		else if (checkStraight(rankArr) != false) {
			 return checkStraight(rankArr);
		}
		else if (checkPair(rankArr)!=false) {
			 return checkPair(rankArr);
		}
		else {
			return checkHighCard(rankArr);
		}



  }


bestPlayerHand = getBestHand(playerCardRanks,playerSuites);

bestDealerHand = getBestHand(dealerCardRanks,dealerSuites);

console.log(bestDealerHand);
console.log(bestPlayerHand);

getWinner(bestDealerHand,bestPlayerHand);

function getWinner(dealer,player) {



	if ((dealer.rankOfHand == 1) && (dealer.highToLow[0] < 12)) {
		return console.log('dealer does not qualify, player ante bet paid even money and play bet is returned');
	}


	if (dealer.rankOfHand == player.rankOfHand) {

		if ((player.rankOfHand == 4) || (player.rankOfHand == 5) || (player.rankOfHand == 6)) {

					 if (player.highToLow > dealer.highToLow) {
					 	return console.log('player wins');
					 }
					else if (player.highToLow < dealer.highToLow) {
						return console.log('dealer wins'); }
					else {
						 return console.log('this is a push');
					   }
		}

		else if ((player.rankOfHand == 1) || (player.rankOfHand == 3)) {

			playerWins = false;
			dealerWins = false;

			var c = 0;

			while (c < 3) {

					plCard = Number(player.highToLow[c]);
					dlCard = Number(dealer.highToLow[c]);

				if (plCard > dlCard) {
					playerWins = true;
					console.log('player wins with '+player.highToLow[c]+ 'against dealers: '+dealer.highToLow[c]);
					break;
				}
				else if (dlCard > plCard) {
					dealerWins = true;
					console.log('dealer wins with '+dealer.highToLow[c])
					break;
				}

			c++;
			};
			console.log('c is :'+c);

		console.log('player wins = '+playerWins);
		console.log('dealer wins = '+dealerWins);
		if (playerWins) {
			return console.log('player wins. high card '+player.highToLow[c]);
		}
		else if (dealerWins){
			return console.log('dealer wins. high card '+dealer.highToLow[c]);
		}
		else {return console.log('this is a push');}
		}

	// if both have pairs

	else if ((player.rankOfHand == 2) && (dealer.rankOfHand == 2)) {
		if ((Number(player.highPairCard)) > (Number(dealer.highPairCard))) {
			console.log('Player wins. Player pair is higher than dealer pair');
		}
		else if ((Number(player.highPairCard)) < (Number(dealer.highPairCard))) {
			console.log('Dealer wins. Dealer pair is higher than player pair');
		}
		else { 
			if ((Number(player.kicker)) > (Number(dealer.kicker))){
				console.log('player wins pair with kicker: '+player.kicker);
			}
			else if ((Number(player.kicker)) < (Number(dealer.kicker))){
				console.log('dealer wins pair with kicker: '+dealer.kicker);
			}
			else { console.log('This pair is a push');}

		}
	}
  }	
	
	else if (dealer.rankOfHand > player.rankOfHand) {
		console.log('dealer won with hand '+dealer.nameOfHand);
	}
	else if (dealer.rankOfHand < player.rankOfHand){
		console.log('player wins with hand '+player.nameOfHand);
	}
	
}


</script>


</body>
</html>

